---
title: "assignment2"
date: "May 7, 2020"
output: html_document
---


##Introduction
The purpose of this assignment is t is to learn the main advantages and disadvantages of some machine learning regression methods by comparing:

* regression trees,
* bagging,
* random forest,
*  kernel approaches

</br>

##Data pre-processing

```{r, message=FALSE}
library(mice)
library(GGally)
library(geosphere)
library(dplyr)
library(VIM)


dataOriginal <- read.csv("Melbourne_housing_FULL.csv", header = TRUE, na.strings=c("", "NA", "#N/A"))

```


```{r, echo=FALSE}
# Fix date format
dataOriginal$Date<-as.Date(dataOriginal$Date, "%d/%m/%Y")
```

### NA values
Let's vizualise NA values
```{r}
aggr(dataOriginal,delimiter=NULL, plot=TRUE)
```

####Discard NA values of price
```{r}
dataOriginal <- dataOriginal[!is.na(dataOriginal$Price),]
```

####Replacing NA values

You can also embed plots, for example:

```{r}
#we don't need to do that apriori, but only if there will be any technique that doesn't work with NA 
set.seed(101) 
init = mice(dataOriginal, maxit=0) 
dataComplete <- complete(init)
```
</br>

###The target variable

####Distribution
```{r}
hist(dataOriginal$Price,col=4, main=paste("Price"), xlab="A$")
```

#### Logarithmic distribution
```{r}
hist(log10(dataOriginal$Price),col=5, main=paste("Price"),xlab="log10(A$)")
```

### Aggregating attributes and deriving new columns
```{r}

# Add year column and street column
addresses<-gsub("[[:punct:]]", "", dataOriginal$Address)
addresses<-gsub("[[:digit:]]", "", addresses)

data<-mutate(dataOriginal, Street=addresses, YearSaled=year(dataOriginal$Date))

# Add season column
data<-mutate(data, Season=ifelse(month(data$Date) %in% 3:5, "Spring",ifelse(month(data$Date) %in% 6:8, "summer", ifelse(month(data$Date) %in% 9:11, "Autumn","Winter"))))

# Remove unuseful columns
data<-select(data,-c(Address,Date))

# Add a column with the distance to the center of the bay
MelbourneBayCentre <- cbind(144.783832, -38.104275)
data <- mutate(data, DistanceToBayCentre = distGeo(cbind(Longtitude, Lattitude), MelbourneBayCentre)/1000) #in km

# Add a column with the distance to the airports
MelbourneAirport<-c( 144.841802,-37.670149)
AvalonAirport<- c( 144.473152,-38.027377)
EssendonAirport<- c( 144.902035,-37.726376)
MoorabbinAirport <- c( 145.100306,-37.979454)
data<-mutate(data,DistanceToAirports = pmin(distGeo(cbind(Longtitude,Lattitude), MelbourneAirport), distGeo(cbind(Longtitude,Lattitude), AvalonAirport), distGeo(cbind(Longtitude,Lattitude), EssendonAirport), distGeo(cbind(Longtitude,Lattitude), MoorabbinAirport))/1000) #in km
```

</br>

#### Summary of data
```{r}
str(data)
summary(data)
```